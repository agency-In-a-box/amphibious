<!-- Modern Filter System HTML -->
<aside class="catalog-sidebar">
  <div class="filters-modern" id="filtersPanel">
    <!-- Filter Header -->
    <div class="filters-header">
      <h2 class="filters-title">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
        </svg>
        Filters
      </h2>
      <button class="filters-clear" onclick="clearAllFilters()">Clear all</button>
    </div>

    <!-- Active Filters Display -->
    <div class="active-filters" id="activeFilters">
      <div class="active-filters-label">Active Filters</div>
      <div class="filter-tags" id="filterTags">
        <span class="filter-tag">
          T-Shirts
          <button class="filter-tag-remove">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </span>
        <span class="filter-tag">
          $50 - $100
          <button class="filter-tag-remove">
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </span>
      </div>
    </div>

    <!-- Category Filter Group -->
    <div class="filter-group" data-filter="category">
      <div class="filter-group-header" onclick="toggleFilterGroup(this)">
        <h3 class="filter-group-title">Category</h3>
        <span class="filter-group-toggle">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
      </div>
      <div class="filter-group-content">
        <label class="filter-item">
          <input type="checkbox" name="category" value="tshirts">
          <span class="filter-checkbox"></span>
          <span class="filter-label">
            T-Shirts
            <span class="filter-count">42</span>
          </span>
        </label>
        <label class="filter-item">
          <input type="checkbox" name="category" value="jeans">
          <span class="filter-checkbox"></span>
          <span class="filter-label">
            Jeans
            <span class="filter-count">28</span>
          </span>
        </label>
        <label class="filter-item">
          <input type="checkbox" name="category" value="dresses">
          <span class="filter-checkbox"></span>
          <span class="filter-label">
            Dresses
            <span class="filter-count">35</span>
          </span>
        </label>
        <label class="filter-item">
          <input type="checkbox" name="category" value="shoes">
          <span class="filter-checkbox"></span>
          <span class="filter-label">
            Shoes
            <span class="filter-count">51</span>
          </span>
        </label>
      </div>
    </div>

    <!-- Brand Dropdown Filter -->
    <div class="filter-group" data-filter="brand">
      <div class="filter-group-header" onclick="toggleFilterGroup(this)">
        <h3 class="filter-group-title">Brand</h3>
        <span class="filter-group-toggle">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
      </div>
      <div class="filter-group-content">
        <div class="filter-dropdown" id="brandDropdown">
          <button class="filter-dropdown-trigger" onclick="toggleDropdown(this)">
            <span>Select Brand</span>
            <svg class="filter-dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div class="filter-dropdown-menu">
            <div class="filter-dropdown-option" onclick="selectBrand(this, 'Nike')">
              Nike
              <span class="filter-count">28</span>
            </div>
            <div class="filter-dropdown-option" onclick="selectBrand(this, 'Adidas')">
              Adidas
              <span class="filter-count">24</span>
            </div>
            <div class="filter-dropdown-option" onclick="selectBrand(this, 'Puma')">
              Puma
              <span class="filter-count">19</span>
            </div>
            <div class="filter-dropdown-option" onclick="selectBrand(this, 'Under Armour')">
              Under Armour
              <span class="filter-count">16</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Price Range Filter -->
    <div class="filter-group" data-filter="price">
      <div class="filter-group-header" onclick="toggleFilterGroup(this)">
        <h3 class="filter-group-title">Price Range</h3>
        <span class="filter-group-toggle">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
      </div>
      <div class="filter-group-content">
        <div class="price-range-container">
          <div class="price-slider">
            <div class="price-slider-fill"></div>
            <div class="price-slider-handle min"></div>
            <div class="price-slider-handle max"></div>
          </div>
          <div class="price-inputs">
            <div class="price-input-group">
              <input type="number" min="0" max="500" value="25" id="minPrice">
            </div>
            <span class="price-separator">â€“</span>
            <div class="price-input-group">
              <input type="number" min="0" max="500" value="250" id="maxPrice">
            </div>
          </div>
        </div>
        <!-- Quick price options -->
        <label class="filter-item">
          <input type="radio" name="price" value="0-25">
          <span class="filter-radio"></span>
          <span class="filter-label">Under $25</span>
        </label>
        <label class="filter-item">
          <input type="radio" name="price" value="25-50">
          <span class="filter-radio"></span>
          <span class="filter-label">$25 - $50</span>
        </label>
        <label class="filter-item">
          <input type="radio" name="price" value="50-100">
          <span class="filter-radio"></span>
          <span class="filter-label">$50 - $100</span>
        </label>
        <label class="filter-item">
          <input type="radio" name="price" value="100+">
          <span class="filter-radio"></span>
          <span class="filter-label">Over $100</span>
        </label>
      </div>
    </div>

    <!-- Size Filter -->
    <div class="filter-group" data-filter="size">
      <div class="filter-group-header" onclick="toggleFilterGroup(this)">
        <h3 class="filter-group-title">Size</h3>
        <span class="filter-group-toggle">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
      </div>
      <div class="filter-group-content">
        <div class="size-options">
          <button class="size-option" onclick="toggleSize(this)">XS</button>
          <button class="size-option" onclick="toggleSize(this)">S</button>
          <button class="size-option selected" onclick="toggleSize(this)">M</button>
          <button class="size-option" onclick="toggleSize(this)">L</button>
          <button class="size-option" onclick="toggleSize(this)">XL</button>
          <button class="size-option unavailable">XXL</button>
        </div>
      </div>
    </div>

    <!-- Color Filter -->
    <div class="filter-group" data-filter="color">
      <div class="filter-group-header" onclick="toggleFilterGroup(this)">
        <h3 class="filter-group-title">Color</h3>
        <span class="filter-group-toggle">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
      </div>
      <div class="filter-group-content">
        <div class="color-swatches">
          <button class="color-swatch" onclick="toggleColor(this)" title="Black">
            <div class="color-swatch-inner" style="background: #000000;"></div>
          </button>
          <button class="color-swatch" onclick="toggleColor(this)" title="White">
            <div class="color-swatch-inner" style="background: #ffffff;"></div>
          </button>
          <button class="color-swatch selected" onclick="toggleColor(this)" title="Blue">
            <div class="color-swatch-inner" style="background: #3b82f6;"></div>
          </button>
          <button class="color-swatch" onclick="toggleColor(this)" title="Red">
            <div class="color-swatch-inner" style="background: #ef4444;"></div>
          </button>
          <button class="color-swatch" onclick="toggleColor(this)" title="Green">
            <div class="color-swatch-inner" style="background: #10b981;"></div>
          </button>
          <button class="color-swatch" onclick="toggleColor(this)" title="Yellow">
            <div class="color-swatch-inner" style="background: #f59e0b;"></div>
          </button>
          <button class="color-swatch" onclick="toggleColor(this)" title="Purple">
            <div class="color-swatch-inner" style="background: #8b5cf6;"></div>
          </button>
          <button class="color-swatch" onclick="toggleColor(this)" title="Pink">
            <div class="color-swatch-inner" style="background: #ec4899;"></div>
          </button>
        </div>
      </div>
    </div>

    <!-- Apply Filters -->
    <div class="filters-apply">
      <button class="filters-apply-button" onclick="applyFilters()">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        Apply Filters
      </button>
      <div class="filter-result-count">Showing 42 of 156 products</div>
    </div>
  </div>
</aside>

<!-- Mobile Filter Toggle Button -->
<button class="mobile-filter-toggle" onclick="toggleMobileFilters()">
  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
  </svg>
  Filters
</button>

<!-- Filter Overlay for Mobile -->
<div class="filters-overlay" id="filtersOverlay" onclick="closeMobileFilters()"></div>

<script>
// Toggle filter group collapse
function toggleFilterGroup(header) {
  const group = header.parentElement;
  group.classList.toggle('collapsed');
}

// Toggle dropdown
function toggleDropdown(trigger) {
  const dropdown = trigger.parentElement;
  dropdown.classList.toggle('open');
}

// Select brand from dropdown
function selectBrand(option, brand) {
  const dropdown = option.closest('.filter-dropdown');
  const trigger = dropdown.querySelector('.filter-dropdown-trigger span');

  // Update selected state
  dropdown.querySelectorAll('.filter-dropdown-option').forEach(opt => {
    opt.classList.remove('selected');
  });
  option.classList.add('selected');

  // Update trigger text
  trigger.textContent = brand;
  trigger.parentElement.classList.add('active');

  // Close dropdown
  dropdown.classList.remove('open');

  // Add to active filters
  addActiveFilter(brand, 'brand');
}

// Toggle size selection
function toggleSize(button) {
  if (!button.classList.contains('unavailable')) {
    button.classList.toggle('selected');
  }
}

// Toggle color selection
function toggleColor(button) {
  button.classList.toggle('selected');
}

// Add active filter tag
function addActiveFilter(text, type) {
  const activeFilters = document.getElementById('activeFilters');
  const filterTags = document.getElementById('filterTags');

  activeFilters.classList.add('has-filters');

  const tag = document.createElement('span');
  tag.className = 'filter-tag';
  tag.dataset.type = type;
  tag.innerHTML = `
    ${text}
    <button class="filter-tag-remove" onclick="removeFilter(this)">
      <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  `;

  filterTags.appendChild(tag);
}

// Remove filter tag
function removeFilter(button) {
  const tag = button.parentElement;
  tag.remove();

  const filterTags = document.getElementById('filterTags');
  const activeFilters = document.getElementById('activeFilters');

  if (filterTags.children.length === 0) {
    activeFilters.classList.remove('has-filters');
  }
}

// Clear all filters
function clearAllFilters() {
  // Clear all checkboxes
  document.querySelectorAll('.filter-item input').forEach(input => {
    input.checked = false;
  });

  // Clear all selections
  document.querySelectorAll('.size-option.selected').forEach(btn => {
    btn.classList.remove('selected');
  });

  document.querySelectorAll('.color-swatch.selected').forEach(btn => {
    btn.classList.remove('selected');
  });

  // Clear dropdowns
  document.querySelectorAll('.filter-dropdown-trigger span').forEach(span => {
    span.textContent = span.textContent.includes('Brand') ? 'Select Brand' : span.textContent;
  });

  // Clear active filters
  document.getElementById('filterTags').innerHTML = '';
  document.getElementById('activeFilters').classList.remove('has-filters');

  // Reset price range
  document.getElementById('minPrice').value = 25;
  document.getElementById('maxPrice').value = 250;
}

// Apply filters
function applyFilters() {
  console.log('Applying filters...');
  // In a real app, this would trigger the product filtering
}

// Mobile filter toggle
function toggleMobileFilters() {
  document.getElementById('filtersPanel').classList.add('open');
  document.getElementById('filtersOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeMobileFilters() {
  document.getElementById('filtersPanel').classList.remove('open');
  document.getElementById('filtersOverlay').classList.remove('open');
  document.body.style.overflow = '';
}

// Initialize active filters display
document.addEventListener('DOMContentLoaded', function() {
  // Add event listeners for checkboxes
  document.querySelectorAll('.filter-item input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', function() {
      if (this.checked) {
        const label = this.nextElementSibling.nextElementSibling.textContent.trim().split('\n')[0];
        addActiveFilter(label, this.name);
      }
    });
  });

  // Close dropdowns when clicking outside
  document.addEventListener('click', function(e) {
    if (!e.target.closest('.filter-dropdown')) {
      document.querySelectorAll('.filter-dropdown.open').forEach(dropdown => {
        dropdown.classList.remove('open');
      });
    }
  });
});
</script>