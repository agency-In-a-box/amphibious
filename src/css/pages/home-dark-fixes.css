/**
 * Comprehensive Dark Mode Fixes for Homepage
 * Fixes all contrast, visibility, and accessibility issues
 */

/* ==========================================================================
   Key Features Section - Fix invisible text
   ========================================================================== */

@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]) {
    /* Hero Stats */
    .hero .stats .stat-value {
      color: #ffffff !important;
    }

    .hero .stats .stat-label {
      color: rgba(255, 255, 255, 0.9) !important;
    }

    /* Stats Grid Cards */
    .stats-grid .stat-card {
      background: var(--color-surface-elevated, #2c2c2e);
      border: 1px solid var(--color-border, #3a3a3c);
      color: var(--color-text, #ffffff);
    }

    .stat-card__icon {
      color: var(--apple-orange-500, #ff9500);
      opacity: 1;
    }

    .stat-card__icon svg {
      stroke: var(--apple-orange-500, #ff9500);
    }

    .stat-card__number {
      color: var(--color-text, #ffffff) !important;
      font-weight: 600;
    }

    .stat-card__label {
      color: var(--color-text-secondary, #aeaeb2) !important;
    }

    /* Feature boxes in Key Features section */
    #features .feature-box,
    .key-features .feature-box,
    [class*="feature"] .box {
      background: var(--color-surface-elevated, #2c2c2e) !important;
      border: 1px solid var(--color-border, #3a3a3c);
    }

    #features h3,
    #features h4,
    .feature-box h3,
    .feature-box h4 {
      color: var(--color-text, #ffffff) !important;
    }

    #features p,
    .feature-box p {
      color: var(--color-text-secondary, #aeaeb2) !important;
    }

    /* Icons - ensure they're visible */
    [data-lucide],
    .lucide,
    .icon--sm,
    .icon--lg,
    .icon--filled,
    .icon--muted,
    i[class*="icon"] {
      color: var(--color-text, #ffffff);
      stroke: var(--color-text, #ffffff);
      fill: none;
    }

    .icon--warning {
      color: var(--apple-warning, #ffd60a) !important;
      stroke: var(--apple-warning, #ffd60a) !important;
    }

    .icon--filled.icon--warning {
      fill: var(--apple-warning, #ffd60a) !important;
    }

    .icon--muted {
      color: var(--color-text-quaternary, #636366) !important;
      stroke: var(--color-text-quaternary, #636366) !important;
    }

    /* Icon buttons */
    .icon-button {
      background: var(--color-surface-elevated, #2c2c2e);
      border-color: var(--color-border, #3a3a3c);
      color: var(--color-text, #ffffff);
    }

    .icon-button:hover {
      background: var(--color-surface-overlay, #3a3a3c);
      border-color: var(--apple-orange-500, #ff9500);
    }

    /* What's New section */
    #whats-new h2,
    #whats-new h3,
    #whats-new h4,
    .whats-new-title {
      color: var(--color-text, #ffffff) !important;
    }

    #whats-new p,
    #whats-new .description {
      color: var(--color-text-secondary, #aeaeb2) !important;
    }

    /* Recent Updates Section - Fix white text on light background */
    .updates-section h2,
    .updates-section h3,
    #updates-title {
      color: var(--color-text, #ffffff) !important;
    }

    .updates-section p {
      color: var(--color-text-secondary, #aeaeb2) !important;
    }

    /* Slats with images - ensure proper dark mode */
    .slats--with-image li {
      background: var(--color-surface-elevated, #2c2c2e);
      border: 1px solid var(--color-border, #3a3a3c);
    }

    .slats--with-image h3 {
      color: var(--color-text, #ffffff) !important;
    }

    .slats--with-image p {
      color: var(--color-text-secondary, #aeaeb2) !important;
    }

    .slats--with-image .meta {
      color: var(--color-text-tertiary, #8e8e93) !important;
    }

    .slats--with-image a {
      color: inherit;
    }

    .slats--with-image a:hover {
      background: var(--color-surface-overlay, #3a3a3c);
    }

    /* Component cards */
    .component-card {
      background: var(--color-surface-elevated, #2c2c2e) !important;
      border: 1px solid var(--color-border, #3a3a3c);
    }

    .component-card h3,
    .component-card h4 {
      color: var(--color-text, #ffffff) !important;
    }

    .component-card p {
      color: var(--color-text-secondary, #aeaeb2) !important;
    }

    /* Code blocks */
    code,
    pre,
    .code-snippet {
      background: var(--color-surface, #1c1c1e) !important;
      color: var(--color-text, #ffffff) !important;
      border-color: var(--color-border, #3a3a3c);
    }

    /* Alerts in dark mode */
    .alert {
      border-color: var(--color-border, #3a3a3c);
    }

    .alert-success {
      background: rgba(48, 209, 88, 0.1);
      color: var(--apple-success, #30d158);
      border-color: rgba(48, 209, 88, 0.3);
    }

    .alert-info {
      background: rgba(10, 132, 255, 0.1);
      color: var(--apple-info, #0a84ff);
      border-color: rgba(10, 132, 255, 0.3);
    }

    .alert-warning {
      background: rgba(255, 214, 10, 0.1);
      color: var(--apple-warning, #ffd60a);
      border-color: rgba(255, 214, 10, 0.3);
    }

    .alert-danger {
      background: rgba(255, 69, 58, 0.1);
      color: var(--apple-danger, #ff453a);
      border-color: rgba(255, 69, 58, 0.3);
    }

    /* Meta text */
    .meta,
    .text-muted {
      color: var(--color-text-secondary, #aeaeb2) !important;
    }

    /* Links in dark mode */
    a:not(.btn):not(.nav-link) {
      color: var(--apple-info, #0a84ff);
    }

    a:not(.btn):not(.nav-link):hover {
      color: #409cff;
    }

    /* Navigation fixes */
    .site-nav {
      background: var(--color-surface, #1c1c1e);
      border-bottom: 1px solid var(--color-border, #3a3a3c);
    }

    .site-nav a {
      color: var(--color-text, #ffffff);
    }

    .site-nav a:hover {
      color: var(--apple-orange-500, #ff9500);
    }

    /* Ensure all text is readable - fallback */
    body * {
      color: inherit;
    }

    /* Specific white text fixes */
    [style*="color: white"],
    [style*="color:#fff"],
    [style*="color:#ffffff"],
    [style*="color: #fff"],
    [style*="color: #ffffff"] {
      color: var(--color-text, #ffffff) !important;
    }

    /* Ensure minimum contrast for all text */
    p, span, div, li, td, th {
      color: var(--color-text, #ffffff);
    }

    h1, h2, h3, h4, h5, h6 {
      color: var(--color-text, #ffffff) !important;
    }
  }
}

/* Manual dark mode - same rules */
[data-theme="dark"] {
  /* Copy all the rules above for manual dark mode */
  .hero .stats .stat-value {
    color: #ffffff !important;
  }

  .hero .stats .stat-label {
    color: rgba(255, 255, 255, 0.9) !important;
  }

  .stats-grid .stat-card {
    background: var(--color-surface-elevated, #2c2c2e);
    border: 1px solid var(--color-border, #3a3a3c);
    color: var(--color-text, #ffffff);
  }

  .stat-card__icon {
    color: var(--apple-orange-500, #ff9500);
    opacity: 1;
  }

  .stat-card__icon svg {
    stroke: var(--apple-orange-500, #ff9500);
  }

  .stat-card__number {
    color: var(--color-text, #ffffff) !important;
    font-weight: 600;
  }

  .stat-card__label {
    color: var(--color-text-secondary, #aeaeb2) !important;
  }

  #features .feature-box,
  .key-features .feature-box,
  [class*="feature"] .box {
    background: var(--color-surface-elevated, #2c2c2e) !important;
    border: 1px solid var(--color-border, #3a3a3c);
  }

  #features h3,
  #features h4,
  .feature-box h3,
  .feature-box h4 {
    color: var(--color-text, #ffffff) !important;
  }

  #features p,
  .feature-box p {
    color: var(--color-text-secondary, #aeaeb2) !important;
  }

  [data-lucide],
  .lucide,
  .icon--sm,
  .icon--lg,
  .icon--filled,
  .icon--muted,
  i[class*="icon"] {
    color: var(--color-text, #ffffff);
    stroke: var(--color-text, #ffffff);
    fill: none;
  }

  .icon--warning {
    color: var(--apple-warning, #ffd60a) !important;
    stroke: var(--apple-warning, #ffd60a) !important;
  }

  .icon--filled.icon--warning {
    fill: var(--apple-warning, #ffd60a) !important;
  }

  .icon--muted {
    color: var(--color-text-quaternary, #636366) !important;
    stroke: var(--color-text-quaternary, #636366) !important;
  }

  .icon-button {
    background: var(--color-surface-elevated, #2c2c2e);
    border-color: var(--color-border, #3a3a3c);
    color: var(--color-text, #ffffff);
  }

  .icon-button:hover {
    background: var(--color-surface-overlay, #3a3a3c);
    border-color: var(--apple-orange-500, #ff9500);
  }

  #whats-new h2,
  #whats-new h3,
  #whats-new h4,
  .whats-new-title {
    color: var(--color-text, #ffffff) !important;
  }

  #whats-new p,
  #whats-new .description {
    color: var(--color-text-secondary, #aeaeb2) !important;
  }

  /* Recent Updates Section - Fix white text on light background */
  .updates-section h2,
  .updates-section h3,
  #updates-title {
    color: var(--color-text, #ffffff) !important;
  }

  .updates-section p {
    color: var(--color-text-secondary, #aeaeb2) !important;
  }

  /* Slats with images - ensure proper dark mode */
  .slats--with-image li {
    background: var(--color-surface-elevated, #2c2c2e);
    border: 1px solid var(--color-border, #3a3a3c);
  }

  .slats--with-image h3 {
    color: var(--color-text, #ffffff) !important;
  }

  .slats--with-image p {
    color: var(--color-text-secondary, #aeaeb2) !important;
  }

  .slats--with-image .meta {
    color: var(--color-text-tertiary, #8e8e93) !important;
  }

  .slats--with-image a {
    color: inherit;
  }

  .slats--with-image a:hover {
    background: var(--color-surface-overlay, #3a3a3c);
  }

  .component-card {
    background: var(--color-surface-elevated, #2c2c2e) !important;
    border: 1px solid var(--color-border, #3a3a3c);
  }

  .component-card h3,
  .component-card h4 {
    color: var(--color-text, #ffffff) !important;
  }

  .component-card p {
    color: var(--color-text-secondary, #aeaeb2) !important;
  }

  code,
  pre,
  .code-snippet {
    background: var(--color-surface, #1c1c1e) !important;
    color: var(--color-text, #ffffff) !important;
    border-color: var(--color-border, #3a3a3c);
  }

  .alert {
    border-color: var(--color-border, #3a3a3c);
  }

  .alert-success {
    background: rgba(48, 209, 88, 0.1);
    color: var(--apple-success, #30d158);
    border-color: rgba(48, 209, 88, 0.3);
  }

  .alert-info {
    background: rgba(10, 132, 255, 0.1);
    color: var(--apple-info, #0a84ff);
    border-color: rgba(10, 132, 255, 0.3);
  }

  .alert-warning {
    background: rgba(255, 214, 10, 0.1);
    color: var(--apple-warning, #ffd60a);
    border-color: rgba(255, 214, 10, 0.3);
  }

  .alert-danger {
    background: rgba(255, 69, 58, 0.1);
    color: var(--apple-danger, #ff453a);
    border-color: rgba(255, 69, 58, 0.3);
  }

  .meta,
  .text-muted {
    color: var(--color-text-secondary, #aeaeb2) !important;
  }

  a:not(.btn):not(.nav-link) {
    color: var(--apple-info, #0a84ff);
  }

  a:not(.btn):not(.nav-link):hover {
    color: #409cff;
  }

  .site-nav {
    background: var(--color-surface, #1c1c1e);
    border-bottom: 1px solid var(--color-border, #3a3a3c);
  }

  .site-nav a {
    color: var(--color-text, #ffffff);
  }

  .site-nav a:hover {
    color: var(--apple-orange-500, #ff9500);
  }

  body * {
    color: inherit;
  }

  [style*="color: white"],
  [style*="color:#fff"],
  [style*="color:#ffffff"],
  [style*="color: #fff"],
  [style*="color: #ffffff"] {
    color: var(--color-text, #ffffff) !important;
  }

  p, span, div, li, td, th {
    color: var(--color-text, #ffffff);
  }

  h1, h2, h3, h4, h5, h6 {
    color: var(--color-text, #ffffff) !important;
  }
}

/* ==========================================================================
   Accessibility Fixes - Ensure WCAG AAA Compliance
   ========================================================================== */

@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]) {
    /* Ensure minimum contrast ratio of 7:1 for normal text */
    /* and 4.5:1 for large text (WCAG AAA) */

    /* Normal text should be at least #aeaeb2 on #1c1c1e background */
    /* Large text can be #8e8e93 on #1c1c1e background */

    .small-text,
    .caption,
    .footnote {
      color: var(--apple-gray-600, #aeaeb2) !important;
    }

    /* Ensure focus indicators are highly visible */
    *:focus-visible {
      outline: 3px solid var(--apple-orange-500, #ff9500) !important;
      outline-offset: 2px !important;
    }
  }
}

[data-theme="dark"] {
  .small-text,
  .caption,
  .footnote {
    color: var(--apple-gray-600, #aeaeb2) !important;
  }

  *:focus-visible {
    outline: 3px solid var(--apple-orange-500, #ff9500) !important;
    outline-offset: 2px !important;
  }
}